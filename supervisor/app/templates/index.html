<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<link rel="shortcut icon" href="style/images/favicon.png">
<title>Robot Control Center</title>
<!-- Bootstrap core CSS -->
<link href="style/css/bootstrap.min.css" rel="stylesheet">
<link href="style/css/plugins.css" rel="stylesheet">
<link href="style.css" rel="stylesheet">
<link href="style/css/color/red.css" rel="stylesheet">
<link href="style/type/bebas.css" rel="stylesheet">
<link href="style/type/fontello.css" rel="stylesheet">
<script>
  iqrSupervisor = {
    manipulatorAddr: "http://192.168.1.175:8383/",
    manipulatorCameraAddr: "http://192.168.1.175:5555/",
    //manipulatorCameraAddr: "http://159.93.44.84:5555/",
    wheeltecAddr: "http://192.168.1.80:5001/",
    pinkmanAddr: "http://192.168.1.177:5001/",
    xrrobotAddr: "http://192.168.1.98:5000/",
    updateStateInterval: 400,
    tpInterval: 500
  };
</script>
<script src="scripts/main.js"></script>
<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
      <script src="style/js/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
      <![endif]-->
</head>
<body>
<div class="body-wrapper">
  <div class="offset"></div>
  <div class="dark-wrapper intro">
    <div class="container inner">
      <h1> Robot Control Center </h1>
      <p>Simulation of the target installation.</p>
      <div style="float:right;margin-top:-49px;display:none;">
        <a class="btn btn-red" id="start_tp">Start tech process</a>
      </div>
    </div>
    <!--/.container -->
  </div>
  <!--/.intro -->
  <div class="offset"></div>
  <!-- <div class="dark-wrapper"> -->
    <div class="container inner">
      <h2>Tech process control</h2>
      
      <div class="divide30"></div>

      <div class="row text-center services-1 dark-wrapper">
        <div class="col-sm-2">
          <div class="col-wrapper" style="padding:30px 10px;">
            <a class="btn btn-green" id="step1" onclick="bmStart(iqrSupervisor);">Step 1</a>
            <div class="divide20"></div>
            <div style="height:80px; clear:both; text-align:left; vertical-align:top;">
              <p>Find cube, take it with blue manipulator and put it to mobile robot.</p>
            </div>
          </div>
        </div>
        <div class="col-sm-2">
          <div class="col-wrapper" style="padding:30px 10px;">
            <a class="btn btn-green" id="step2" onclick="m1Transfer(iqrSupervisor);">Step 2</a>
            <div class="divide20"></div>
            <div style="height:80px; clear:both; text-align:left; vertical-align:top;">
              <p>Transfer cube from blue manipulator to pink manipulator.</p>
            </div>          
          </div>
        </div>
        <div class="col-sm-2">
          <div class="col-wrapper" style="padding:30px 10px;">
            <a class="btn btn-green" id="step3" onclick="pmCatchCube(iqrSupervisor);">Step 3</a>
            <div class="divide20"></div>
            <div style="height:80px; clear:both; text-align:left; vertical-align:top;">
              <p>Take cube with pink manipulator.</p>
            </div>          
          </div>
        </div>
        <div class="col-sm-2">
          <div class="col-wrapper" style="padding:30px 10px;">
            <a class="btn btn-green" id="step4" onclick="m1MoveBack(iqrSupervisor);">Step 4</a>
            <div class="divide20"></div>
            <div style="height:80px; clear:both; text-align:left; vertical-align:top;">
              <p>Move mobile robot back.</p>
            </div>          
          </div>
        </div>
        <div class="col-sm-2">
          <div class="col-wrapper" style="padding:30px 10px;">
            <a class="btn btn-green" id="step5" onclick="pmPutCube(iqrSupervisor);">Step 5</a>
            <div class="divide20"></div>
            <div style="height:80px; clear:both; text-align:left; vertical-align:top;">
              <p>Put cube to pink platform of second mobile robot.</p>
            </div>
          </div>
        </div>
        <div class="col-sm-2">
          <div class="col-wrapper" style="padding:30px 10px;">
            <a class="btn btn-green" id="step6" onclick="m2Transfer(iqrSupervisor);">Step 6</a>
            <div class="divide20"></div>
            <div style="height:80px; clear:both; text-align:left; vertical-align:top;">
              <p>Transfer cube with second mobile robot.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--/.container -->
  <!-- </div> -->

  <div class="container inner">
    <h2 style="margin-bottom:30px;">Robots control</h2>
    <div class="row text-center services-2">
      <div class="col-sm-6">
        <div class="col-wrapper">
          <h3>Blue manipulator</h3>
          <img src="/img/no-video.jpg" width="570" height="427" id="bm_camera">
          <div class="divide20"></div>
          <div class="col-wrapper"  style="text-align:left;">
            <a class="btn btn-green" onclick="bmStart(iqrSupervisor);">Start</a>
            <a class="btn btn-red" onclick="bmReset(iqrSupervisor);">Reset</a>
          </div>
          <div class="divide20"></div>
          <div id="bm_status" style="text-align:left;" class="alert alert-info">No information</div>
        </div>
      </div>
      <div class="col-sm-6">
        <div class="col-wrapper">
          <h3>Pink manipulator</h3>
          <img src="/img/no-video.jpg" width="570" height="427" id="pm_camera">
          <div class="divide20"></div>
          <div class="col-wrapper"  style="text-align:left;">
            <a class="btn btn-green" onclick="pmCatchCube(iqrSupervisor);">Catch Cube</a>
            <a class="btn btn-green" onclick="pmPutCube(iqrSupervisor);">Put Cube</a>
            <a class="btn btn-red" onclick="pmReset(iqrSupervisor);">Reset</a>
          </div>
          <div class="divide20"></div>
          <div id="pm_status" style="text-align:left;" class="alert alert-info">No information</div>
        </div>
      </div>
    </div>
    <div class="divide30"></div>
    <div class="row text-center services-2">
      <div class="col-sm-6">
        <div class="col-wrapper">
          <h3>Mobile robot 1</h3>
          <div class="col-wrapper"  style="text-align:left;">
            <a class="btn btn-green" onclick="m1Transfer(iqrSupervisor);">Transfer Cube</a>
            <a class="btn btn-green" onclick="m1MoveBack(iqrSupervisor);">MoveBack</a>
            <a class="btn btn-red" onclick="m1Reset(iqrSupervisor);">Reset</a>
          </div>
          <div class="divide20"></div>
          <div id="m1_status" style="text-align:left;" class="alert alert-info">No information</div>
        </div>
      </div>
      <div class="col-sm-6">
        <div class="col-wrapper">
          <h3>Mobile robot 2</h3>
          <div class="col-wrapper"  style="text-align:left;">
            <a class="btn btn-green" onclick="m2Transfer(iqrSupervisor);">Transfer Cube</a>
            <a class="btn btn-red" onclick="m2Reset(iqrSupervisor);">Reset</a>
          </div>
          <div class="divide20"></div>
          <div id="m2_status" style="text-align:left;" class="alert alert-info">No information</div>
        </div>
      </div>
    </div>
    <!-- /.services -->
    
  </div>
  <!--/.container -->
    
    <div class="sub-footer">
      <div class="container">
        <p class="pull-left">Â© 2021 IQR LIT. All rights reserved.</p>
      </div>
    </div>
    <div style="float:right;margin-top:-49px;display:none;">
      <a class="btn btn-red" id="update_manip">Update state</a>
    </div>
  </footer>
  <!-- /footer --> 
 
</div>
<!--/.body-wrapper --> 
<!-- <script src="style/js/jquery.min.js"></script> 
<script src="style/js/bootstrap.min.js"></script> 
<script src="style/js/plugins.js"></script> 
<script src="style/js/scripts.js"></script> -->
<script>/*<![CDATA[*/
  document.getElementById("pm_camera").src=iqrSupervisor.pinkmanAddr+"video_feed?random="+new Date().getTime();
  
  // Region Status Updating
  // ------------------------------
  let statusTimeoutIsRuning = false;
  let statusTimeoutId = null;

  async function statusTimeoutFunction(){
    await updManipulatorState();
    await updVehicleState();
    if(statusTimeoutIsRuning){
      statusTimeoutId = setTimeout(
        statusTimeoutFunction,
        iqrSupervisor.updateStateInterval
      );
    }
  };
  
  function StartStatusUpdate(){
    ubtn = document.getElementById("update_manip")
    ubtn.classList.remove('btn-red');
    ubtn.classList.add('btn-gray');
    ubtn.innerHTML = "Stop updating"
    statusTimeoutIsRuning = true;
    statusTimeoutFunction();
  };

  function StopStatusUpdate(){
    statusTimeoutIsRuning = false;
    if (statusTimeoutId!=null) {clearTimeout(statusTimeoutId);}
    ubtn = document.getElementById("update_manip")
    ubtn.classList.remove('btn-gray');
    ubtn.classList.add('btn-red');
    ubtn.innerHTML = "Start updating"
  };

  //StartStatusUpdate();

  //updateBtn = document.getElementById("update_manip")
  //updateBtn.onclick = function(){
  //  if(statusTimeoutIsRuning){ StopStatusUpdate(); }
  //  else { StartStatusUpdate(); }
  //};
  // END -- Region Status Updating
  

  // Region Blue Manipulator Camera Updating
  // ------------------------------
  function bmCameraTimeoutFunction(){
    document.getElementById("bm_camera").src=iqrSupervisor.manipulatorCameraAddr+"video_feed?random="+new Date().getTime();
    bmCameraTimeoutId = setTimeout(
      bmCameraTimeoutFunction,
      400
    );
  };

  bmCameraTimeoutFunction();
  // END -- Region Manipulator Camera Updating


  startBtn = document.getElementById("start_tp")
  startBtn.onclick = function(){
    if (!tpInProgress) { StartTP();}
    else { StopTP(); }
  };
  // END -- Region  TECH PROCESS

  /*]]>*/
</script>
</body>
</html>